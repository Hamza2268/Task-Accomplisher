{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Your Tasks</h2>
    {% if tasks %}
    <div class="list-group">
        {% for task in tasks %}
        <div class="card" id="{{ task.id }}">
            <div style="position: relative;" class="card-header">
                <h2>
                    {{ task.title }}
                </h2>
                <div  class="btn-group btn-group-sm me-3" role="group" aria-label="Task actions">
                    <a href="{{ url_for('edit_task', task_id=task.id) }}"><button type="button" class="btn btn-outline-primary">Edit</button></a>
                    <a href="{{ url_for('delete_task', task_id=task.id) }}"><button type="button" class="btn btn-outline-danger">Delete</button></a>
                    <a href="{{ url_for('complete_task', task_id=task.id) }}"><button id="{{ task.id }}" onclick="Done(this.id)" id="done" type="button" class="btn btn-outline-success">Done</button></a>
                </div>
                <div style=" position: absolute; top: 0; right: 0; padding: 10px;">
                    {% if task.priority == 'Low' %}
                    <span class="badge bg-success">Low</span>
                    {% elif task.priority == 'Medium' %}
                    <span class="badge bg-warning text-dark">Medium</span>
                    {% elif task.priority == 'High' %}
                    <span class="badge bg-danger">High</span>
                    {% elif task.priority == 'Critical' %}
                    <span class="badge bg-dark">Critical</span>
                    {% endif %}
                </div>
            </div>
            <div class="card-body">
                <figure>
                    <blockquote class="blockquote">
                        <p style="font-weight:500">{{ task.description }}</p>
                    </blockquote>
                    <figcaption class="blockquote-footer">
                        {{ task.Deadline }} days <cite title="Source Title"></cite><br>
                        Created on: {{ task.StartDate.strftime('%d-%m-%Y') }} ,End on:
                        {{ task.EndDate.strftime('%d-%m-%Y') }} <br>
                        {% if task.CompletedDate %}
                        Completed on: {{ task.CompletedDate.strftime('%d-%m-%Y' ) }}
                        {% else %}
                        Not completed yet
                        {% endif %}
                    </figcaption>
                </figure>
                <div style="position: relative;height: 10px;">
                    <span class="timeline" data-start="{{ task.StartDate.isoformat() }}"
                        data-end="{{ task.EndDate.isoformat() }}" data-deadline="{{ task.Deadline }}"
                        style="display:inline-block;position: absolute;top:0;left:0;background-color: red;height:100%"></span>
                </div>
            </div>



        </div>

        {% endfor %}
    </div>
    {% else %}
    <p>You have no tasks. <a href="{{ url_for('add_task') }}">Add a new task</a></p>
    {% endif %}
</div>
{% endblock %}